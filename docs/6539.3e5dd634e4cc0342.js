"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6539],{6539:(w,A,g)=>{g.r(A),g.d(A,{WeeklyMeetingsPageModule:()=>W});var v=g(6814),c=g(95),s=g(849),h=g(4408),x=g(7398),b=g(1631),e=g(9212),M=g(3215);const P=["class","meetings"];function k(t,r){if(1&t&&(e.TgZ(0,"form",15),e._UZ(1,"ion-textarea",16),e.qZA()),2&t){const o=e.oxw();e.Q6J("formGroup",o.formGroup)}}function Z(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"ion-card")(1,"ion-card-content")(2,"p"),e._uU(3),e.qZA(),e.TgZ(4,"ion-radio-group",18),e.Uc_("ngModelChange",function(n){const d=e.CHM(o).$implicit;return e.nJJ(d.AttendanceStatus,n)||(d.AttendanceStatus=n),e.KtG(n)}),e.TgZ(5,"ion-radio",19),e._uU(6,"Present"),e.qZA(),e._UZ(7,"br"),e.TgZ(8,"ion-radio",20),e._uU(9,"Excused Absence"),e.qZA(),e._UZ(10,"br"),e.TgZ(11,"ion-radio",21),e._uU(12,"Unexcused Absence"),e.qZA(),e._UZ(13,"br"),e.TgZ(14,"ion-radio",22),e._uU(15,"Excused Tardy"),e.qZA(),e._UZ(16,"br"),e.TgZ(17,"ion-radio",23),e._uU(18,"Unexcused Tardy"),e.qZA(),e._UZ(19,"br"),e.qZA(),e.TgZ(20,"form",15)(21,"div",24)(22,"div",25),e._UZ(23,"ion-textarea",26),e.qZA()()()()()}if(2&t){const o=r.$implicit,i=r.index,n=e.oxw(2);e.xp6(3),e.Oqu(o.residentFullName.value),e.xp6(),e.E3D("ngModel",o.AttendanceStatus),e.xp6(16),e.Q6J("formGroup",n.residentForm),e.xp6(2),e.Q6J("formGroupName",i)}}function C(t,r){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,Z,24,4,"ion-card",17),e.ALo(2,"async"),e._UZ(3,"router-outlet"),e.qZA()),2&t){const o=e.oxw();e.xp6(),e.Q6J("ngForOf",e.lcZ(2,1,o.quickbaseService.residentData))}}function U(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"div",27),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.addWeeklyHouseMeeting())}),e._uU(1," Add Weekly House Meeting "),e._UZ(2,"ion-ripple-effect"),e.qZA()}}function O(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"div",27),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.updateAttendanceRecords())}),e._uU(1," Update Attendance Records "),e._UZ(2,"ion-ripple-effect"),e.qZA()}}function T(t,r){if(1&t&&(e.TgZ(0,"div",28),e._uU(1),e.qZA()),2&t){const o=e.oxw();e.xp6(),e.Oqu(o.message)}}function N(t,r){1&t&&(e.TgZ(0,"div",28),e._uU(1,"Your attendance records have been successfully updated."),e._UZ(2,"br"),e._uU(3,"If you'd like to make any changes,"),e._UZ(4,"br"),e._uU(5,"please contact your Care Navigator."),e.qZA())}const I=[{path:"",component:(()=>{var t;class r{get residentsArray(){return this.residentForm.get("residents")}constructor(i,n,a,d,p){this.quickbaseService=i,this.route=n,this.router=a,this.location=d,this.formBuilder=p,this.HouseLeaderName="",this.theHouseName="",this.HLphone="",this.residentFullName="",this.AttendanceStatus="",this.attendanceUpdated=!1,this.isActivityAdded=!1,this.allResidentsSelected=!1,this.isLoading=!1,this.isActivityAddedOnce=!1,this.activityId=0,this.message="",this.shouldInsertActivity=!1,console.log("WeeklyMeetingsPage constructor called"),this.quickbaseService.residentData.subscribe(_=>{console.log("Resident data received:",_),this.residentData=_}),this.formGroup=new c.cw({Comments:new c.NI(""),ActivityDesc:new c.NI("")}),this.residentForm=this.formBuilder.group({residents:this.formBuilder.array([])});const l=this.router.getCurrentNavigation(),u=null==l?void 0:l.extras.state;u?(console.log("State from router:",u),this.theHouseName=u.theHouseName,this.HouseLeaderName=u.HouseLeaderName,this.HLphone=u.HLphone):console.warn("No state found in router navigation")}addWeeklyHouseMeeting(){this.isLoading=!0;const i=this.quickbaseService.TaskRecordId;console.log("Task Record ID:",i);const n=this.formGroup.value;console.log("New Activity Data",n);const a={6:{value:n.ActivityDesc},89:{value:(new Date).toISOString().split("T")[0]},43:{value:i}};console.log("Activity Body",a),(this.shouldInsertActivity=!0)?this.quickbaseService.insertActivity(a).subscribe(d=>{console.log("Activity inserted successfully",d),this.activityId=d,console.log("New activity ID:",this.activityId),this.isActivityAdded=!0,console.log("Added?",this.isActivityAdded),this.quickbaseService.isActivityAddedOnce=!0,console.log("Added Once?",this.quickbaseService.isActivityAddedOnce)},d=>{console.error("Error inserting activity:",d)}):console.log("shouldInsertActivity is false, skipping insertActivity"),this.isLoading=!1}updateAttendanceRecords(i){this.residentData.filter(a=>!a.AttendanceStatus).length>0?this.message="Please select an attendance status for all participants.":(this.allResidentsSelected=!0,this.residentData.forEach((a,d)=>{var p;console.log("Resident:",a),console.log("AttendanceStatus:",a.AttendanceStatus);const l=null===(p=this.residentForm.get("residents"))||void 0===p||null===(p=p.get(d.toString()))||void 0===p?void 0:p.get("Comments");console.log("Comments:",null==l?void 0:l.value);const u=a.recordNumber2.value,_=i;this.activityId?this.quickbaseService.getAttendance(u,this.activityId).pipe((0,x.U)(f=>{var m;const y=null===(m=f.data[0])||void 0===m?void 0:m[3];return console.log("Attendance record ID:",y),y}),(0,b.z)(f=>{console.log("mergeMap check for attendanceID:",f);const m=f.value,y={11:{value:a.AttendanceStatus?a.AttendanceStatus:null},7:{value:null!=l&&l.value?null==l?void 0:l.value:null}};return console.log("updated Attendance record with Body",_,m,y),this.quickbaseService.updateAttendance(m,y)})).subscribe(f=>{console.log("Attendance record updated successfully for resident",u,":",f)},f=>{console.error("Error updating attendance record for resident",u,":",f)}):console.log("Activity ID is not set")}),this.attendanceUpdated=!0)}goBack(){this.location.back()}ngOnInit(){const i=this.router.getCurrentNavigation(),n=null==i?void 0:i.extras.state;n&&(this.theHouseName=n.theHouseName,this.HouseLeaderName=n.HouseLeaderName,this.HLphone=n.HLphone),this.residentDataSubscription=this.quickbaseService.residentData.subscribe(a=>{a&&Array.isArray(a)&&(this.residentForm=this.formBuilder.group({residents:this.formBuilder.array(a.map(d=>this.formBuilder.group({...d,AttendanceStatus:"",Comments:[""]})))}))})}ngOnDestroy(){this.residentDataSubscription&&this.residentDataSubscription.unsubscribe()}}return(t=r).\u0275fac=function(i){return new(i||t)(e.Y36(M.x),e.Y36(h.gz),e.Y36(h.F0),e.Y36(v.Ye),e.Y36(c.qu))},t.\u0275cmp=e.Xpm({type:t,selectors:[["HOMMA-weekly",8,"meetings"]],attrs:P,decls:36,vars:11,consts:[[3,"translucent"],["color","Primary"],[3,"fullscreen"],[1,"ion-text-center"],["src","assets/logo/HOM3.png","alt","Logo"],[1,"ion-text-left"],["size","1","size-md","2","size-lg","3"],["size","10","size-md","8","size-lg","6"],[3,"formGroup",4,"ngIf"],[4,"ngIf"],["scrollable-content",""],[1,"wrapper"],["class","ion-activatable ripple-parent rounded-rectangle ripple-effect-lightblue",3,"click",4,"ngIf"],["class","message",4,"ngIf"],[1,"ion-activatable","ripple-parent","rounded-rectangle","ripple-effect-blue",3,"click"],[3,"formGroup"],["formControlName","ActivityDesc","label","Enter Activity Description","labelPlacement","floating","placeholder","Please enter the description of the weekly meeting activity here.","value","","autoGrow","true",1,"bordered-input"],[4,"ngFor","ngForOf"],["value","",3,"ngModel","ngModelChange"],["labelPlacement","end","value","Present"],["labelPlacement","end","value","Excused Absence"],["labelPlacement","end","value","Unexcused Absence"],["labelPlacement","end","value","Excused Tardy"],["labelPlacement","end","value","Unexcused Tardy"],["formArrayName","residents"],[3,"formGroupName"],["formControlName","Comments","label","Comments","labelPlacement","floating","placeholder","Please provide reason for unexcused tardiness or absence here","autoGrow","true",1,"bordered-input"],[1,"ion-activatable","ripple-parent","rounded-rectangle","ripple-effect-lightblue",3,"click"],[1,"message"]],template:function(i,n){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),e._uU(3," HOM Mobile Assistant - Weekly House Meetings "),e.qZA()()(),e.TgZ(4,"ion-content",2)(5,"ion-card",3),e._UZ(6,"img",4)(7,"br"),e.TgZ(8,"ion-card-header")(9,"ion-card-title",3),e._uU(10),e._UZ(11,"br"),e._uU(12,"Weekly House Meeting"),e.qZA(),e.TgZ(13,"ion-card-subtitle",5),e._uU(14),e._UZ(15,"br"),e._uU(16),e._UZ(17,"br")(18,"p"),e.qZA()()(),e.TgZ(19,"ion-grid")(20,"ion-row"),e._UZ(21,"ion-col",6),e.TgZ(22,"ion-col",7),e.YNc(23,k,2,1,"form",8),e.qZA(),e._UZ(24,"ion-col",6),e.qZA()(),e.YNc(25,C,4,3,"div",9),e.TgZ(26,"ion-card")(27,"ion-card-content",10)(28,"div",11),e.YNc(29,U,3,0,"div",12)(30,O,3,0,"div",12)(31,T,2,1,"div",13)(32,N,6,0,"div",13),e.TgZ(33,"div",14),e.NdJ("click",function(){return n.goBack()}),e._uU(34," Go Back "),e._UZ(35,"ion-ripple-effect"),e.qZA()()()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(6),e.Oqu(n.theHouseName),e.xp6(4),e.hij("House Leader: ",n.HouseLeaderName,""),e.xp6(2),e.hij(" Phone: ",n.HLphone,""),e.xp6(7),e.Q6J("ngIf",!n.isActivityAdded&&!n.quickbaseService.isActivityAddedOnce),e.xp6(2),e.Q6J("ngIf",n.isActivityAdded),e.xp6(4),e.Q6J("ngIf",!n.isActivityAdded&&!n.quickbaseService.isActivityAddedOnce),e.xp6(),e.Q6J("ngIf",n.isActivityAdded&&!n.attendanceUpdated),e.xp6(),e.Q6J("ngIf",!n.allResidentsSelected),e.xp6(),e.Q6J("ngIf",n.attendanceUpdated))},dependencies:[v.sg,v.O5,c._Y,c.JJ,c.JL,c.On,s.PM,s.FN,s.Zi,s.tO,s.Dq,s.wI,s.W2,s.jY,s.Gu,s.B7,s.se,s.H$,s.Nd,s.g2,s.wd,s.sr,s.U5,s.QI,s.j9,c.sg,c.u,c.x0,c.CE,h.lC,v.Ov],styles:["ion-header[_ngcontent-%COMP%]{--ion-background-color: #4194ab !important;--ion-color-base: #fff !important}ion-title[_ngcontent-%COMP%]{--ion-color-base: #fff !important;font-size:16px}ion-card-header[_ngcontent-%COMP%]{padding-bottom:0;font-weight:700}ion-card-subtitle[_ngcontent-%COMP%]{--ion-color-base: #fff !important;font-size:12px;padding-top:10;margin-top:5px}ion-card-title[_ngcontent-%COMP%]{text-align:left}.error-message[_ngcontent-%COMP%]{color:red;font-size:20px;margin-top:10px}ion-grid.main[_ngcontent-%COMP%]{--ion-grid-padding: 20px;--ion-grid-padding-xs: 20px;--ion-grid-padding-sm: 20px;--ion-grid-padding-md: 20px;--ion-grid-padding-lg: 20px;--ion-grid-padding-xl: 20px;--ion-grid-column-padding: 30px;--ion-grid-column-padding-xs: 30px;--ion-grid-column-padding-sm: 30px;--ion-grid-column-padding-md: 30px;--ion-grid-column-padding-lg: 30px;--ion-grid-column-padding-xl: 30px}ion-col.main[_ngcontent-%COMP%]{background-color:transparent;border:solid 1px #4194ab;color:#0a056f;text-align:center}.bordered-input[_ngcontent-%COMP%]{box-sizing:border-box;border:1px solid #000;border-radius:5px;margin:10px 0;padding:0 15px}.message[_ngcontent-%COMP%]{color:red;font-weight:700}#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:14px;line-height:18px}.fields-container[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;line-height:16px;color:#2b9c4d;margin:0}.info-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.info-item[_ngcontent-%COMP%]{margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}ion-buttons[_ngcontent-%COMP%]{font-size:1.1em}.ripple-effect-blue[_ngcontent-%COMP%]{color:#010384}.ripple-effect-lightblue[_ngcontent-%COMP%]{color:#00c8ff}.ripple-effect-red[_ngcontent-%COMP%]{color:#980707}.wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;text-align:center;height:100px;width:300px;margin:0 auto}b[_ngcontent-%COMP%]{width:100%}.ripple-parent[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;border:1px solid #4194ab;width:100%;height:50px;border-radius:8px}.rounded-rectangle[_ngcontent-%COMP%]{width:350px;height:30px;border-radius:8px}"]}),r})()}];let S=(()=>{var t;class r{}return(t=r).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.Bz.forChild(I),h.Bz]}),r})(),W=(()=>{var t;class r{}return(t=r).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.ez,c.u5,s.Pc,c.UX,S]}),r})()}}]);