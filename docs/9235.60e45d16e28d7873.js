"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9235],{2726:(ae,M,f)=>{f.d(M,{Sd:()=>G,Uw:()=>j,fo:()=>A});var u=f(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var R=function(l){return l.Unimplemented="UNIMPLEMENTED",l.Unavailable="UNAVAILABLE",l}(R||{});class I extends Error{constructor(o,i,d){super(o),this.message=o,this.code=i,this.data=d}}const B=l=>{var o,i,d,r,a;const c=l.CapacitorCustomPlatform||null,t=l.Capacitor||{},n=t.Plugins=t.Plugins||{},s=l.CapacitorPlatforms,h=(null===(o=null==s?void 0:s.currentPlatform)||void 0===o?void 0:o.getPlatform)||(()=>null!==c?c.name:(l=>{var o,i;return null!=l&&l.androidBridge?"android":null!==(i=null===(o=null==l?void 0:l.webkit)||void 0===o?void 0:o.messageHandlers)&&void 0!==i&&i.bridge?"ios":"web"})(l)),$=(null===(i=null==s?void 0:s.currentPlatform)||void 0===i?void 0:i.isNativePlatform)||(()=>"web"!==h()),q=(null===(d=null==s?void 0:s.currentPlatform)||void 0===d?void 0:d.isPluginAvailable)||(m=>{const b=ne.get(m);return!!(null!=b&&b.platforms.has(h())||N(m))}),N=(null===(r=null==s?void 0:s.currentPlatform)||void 0===r?void 0:r.getPluginHeader)||(m=>{var b;return null===(b=t.PluginHeaders)||void 0===b?void 0:b.find(S=>S.name===m)}),ne=new Map,he=(null===(a=null==s?void 0:s.currentPlatform)||void 0===a?void 0:a.registerPlugin)||((m,b={})=>{const S=ne.get(m);if(S)return console.warn(`Capacitor plugin "${m}" already registered. Cannot register plugins twice.`),S.proxy;const E=h(),L=N(m);let O;const be=function(){var P=(0,u.Z)(function*(){return!O&&E in b?O=O="function"==typeof b[E]?yield b[E]():b[E]:null!==c&&!O&&"web"in b&&(O=O="function"==typeof b.web?yield b.web():b.web),O});return function(){return P.apply(this,arguments)}}(),re=P=>{let _;const T=(...U)=>{const x=be().then(Z=>{const F=((P,_)=>{var T,U;if(!L){if(P)return null===(U=P[_])||void 0===U?void 0:U.bind(P);throw new I(`"${m}" plugin is not implemented on ${E}`,R.Unimplemented)}{const x=null==L?void 0:L.methods.find(Z=>_===Z.name);if(x)return"promise"===x.rtype?Z=>t.nativePromise(m,_.toString(),Z):(Z,F)=>t.nativeCallback(m,_.toString(),Z,F);if(P)return null===(T=P[_])||void 0===T?void 0:T.bind(P)}})(Z,P);if(F){const W=F(...U);return _=null==W?void 0:W.remove,W}throw new I(`"${m}.${P}()" is not implemented on ${E}`,R.Unimplemented)});return"addListener"===P&&(x.remove=(0,u.Z)(function*(){return _()})),x};return T.toString=()=>`${P.toString()}() { [capacitor code] }`,Object.defineProperty(T,"name",{value:P,writable:!1,configurable:!1}),T},pe=re("addListener"),fe=re("removeListener"),_e=(P,_)=>{const T=pe({eventName:P},_),U=function(){var Z=(0,u.Z)(function*(){const F=yield T;fe({eventName:P,callbackId:F},_)});return function(){return Z.apply(this,arguments)}}(),x=new Promise(Z=>T.then(()=>Z({remove:U})));return x.remove=(0,u.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield U()}),x},ie=new Proxy({},{get(P,_){switch(_){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return L?_e:pe;case"removeListener":return fe;default:return re(_)}}});return n[m]=ie,ne.set(m,{name:m,proxy:ie,platforms:new Set([...Object.keys(b),...L?[E]:[]])}),ie});return t.convertFileSrc||(t.convertFileSrc=m=>m),t.getPlatform=h,t.handleError=m=>l.console.error(m),t.isNativePlatform=$,t.isPluginAvailable=q,t.pluginMethodNoop=(m,b,S)=>Promise.reject(`${S} does not have an implementation of "${b}".`),t.registerPlugin=he,t.Exception=I,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t.platform=t.getPlatform(),t.isNative=t.isNativePlatform(),t},w=(l=>l.Capacitor=B(l))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),A=w.registerPlugin;class j{constructor(o){this.listeners={},this.windowListeners={},o&&(console.warn(`Capacitor WebPlugin "${o.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=o)}addListener(o,i){var d=this;this.listeners[o]||(this.listeners[o]=[]),this.listeners[o].push(i);const a=this.windowListeners[o];a&&!a.registered&&this.addWindowListener(a);const c=function(){var n=(0,u.Z)(function*(){return d.removeListener(o,i)});return function(){return n.apply(this,arguments)}}(),t=Promise.resolve({remove:c});return Object.defineProperty(t,"remove",{value:(n=(0,u.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield c()}),function(){return n.apply(this,arguments)})}),t;var n}removeAllListeners(){var o=this;return(0,u.Z)(function*(){o.listeners={};for(const i in o.windowListeners)o.removeWindowListener(o.windowListeners[i]);o.windowListeners={}})()}notifyListeners(o,i){const d=this.listeners[o];d&&d.forEach(r=>r(i))}hasListeners(o){return!!this.listeners[o].length}registerWindowListener(o,i){this.windowListeners[i]={registered:!1,windowEventName:o,pluginEventName:i,handler:d=>{this.notifyListeners(i,d)}}}unimplemented(o="not implemented"){return new w.Exception(o,R.Unimplemented)}unavailable(o="not available"){return new w.Exception(o,R.Unavailable)}removeListener(o,i){var d=this;return(0,u.Z)(function*(){const r=d.listeners[o];if(!r)return;const a=r.indexOf(i);d.listeners[o].splice(a,1),d.listeners[o].length||d.removeWindowListener(d.windowListeners[o])})()}addWindowListener(o){window.addEventListener(o.windowEventName,o.handler),o.registered=!0}removeWindowListener(o){o&&(window.removeEventListener(o.windowEventName,o.handler),o.registered=!1)}}const H=l=>encodeURIComponent(l).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),J=l=>l.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class z extends j{getCookies(){return(0,u.Z)(function*(){const o=document.cookie,i={};return o.split(";").forEach(d=>{if(d.length<=0)return;let[r,a]=d.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=J(r).trim(),a=J(a).trim(),i[r]=a}),i})()}setCookie(o){return(0,u.Z)(function*(){try{const i=H(o.key),d=H(o.value),r=`; expires=${(o.expires||"").replace("expires=","")}`,a=(o.path||"/").replace("path=",""),c=null!=o.url&&o.url.length>0?`domain=${o.url}`:"";document.cookie=`${i}=${d||""}${r}; path=${a}; ${c};`}catch(i){return Promise.reject(i)}})()}deleteCookie(o){return(0,u.Z)(function*(){try{document.cookie=`${o.key}=; Max-Age=0`}catch(i){return Promise.reject(i)}})()}clearCookies(){return(0,u.Z)(function*(){try{const o=document.cookie.split(";")||[];for(const i of o)document.cookie=i.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(o){return Promise.reject(o)}})()}clearAllCookies(){var o=this;return(0,u.Z)(function*(){try{yield o.clearCookies()}catch(i){return Promise.reject(i)}})()}}A("CapacitorCookies",{web:()=>new z});const V=function(){var l=(0,u.Z)(function*(o){return new Promise((i,d)=>{const r=new FileReader;r.onload=()=>{const a=r.result;i(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>d(a),r.readAsDataURL(o)})});return function(i){return l.apply(this,arguments)}}(),G=(l,o={})=>{const i=Object.assign({method:l.method||"GET",headers:l.headers},o),r=((l={})=>{const o=Object.keys(l);return Object.keys(l).map(r=>r.toLocaleLowerCase()).reduce((r,a,c)=>(r[a]=l[o[c]],r),{})})(l.headers)["content-type"]||"";if("string"==typeof l.data)i.body=l.data;else if(r.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[c,t]of Object.entries(l.data||{}))a.set(c,t);i.body=a.toString()}else if(r.includes("multipart/form-data")||l.data instanceof FormData){const a=new FormData;if(l.data instanceof FormData)l.data.forEach((t,n)=>{a.append(n,t)});else for(const t of Object.keys(l.data))a.append(t,l.data[t]);i.body=a;const c=new Headers(i.headers);c.delete("content-type"),i.headers=c}else(r.includes("application/json")||"object"==typeof l.data)&&(i.body=JSON.stringify(l.data));return i};class te extends j{request(o){return(0,u.Z)(function*(){const i=G(o,o.webFetchExtra),d=((l,o=!0)=>l?Object.entries(l).reduce((d,r)=>{const[a,c]=r;let t,n;return Array.isArray(c)?(n="",c.forEach(s=>{t=o?encodeURIComponent(s):s,n+=`${a}=${t}&`}),n.slice(0,-1)):(t=o?encodeURIComponent(c):c,n=`${a}=${t}`),`${d}&${n}`},"").substr(1):null)(o.params,o.shouldEncodeUrlParams),r=d?`${o.url}?${d}`:o.url,a=yield fetch(r,i),c=a.headers.get("content-type")||"";let n,s,{responseType:t="text"}=a.ok?o:{};switch(c.includes("application/json")&&(t="json"),t){case"arraybuffer":case"blob":s=yield a.blob(),n=yield V(s);break;case"json":n=yield a.json();break;default:n=yield a.text()}const g={};return a.headers.forEach((h,y)=>{g[y]=h}),{data:n,headers:g,status:a.status,url:a.url}})()}get(o){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},o),{method:"GET"}))})()}post(o){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},o),{method:"POST"}))})()}put(o){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},o),{method:"PUT"}))})()}patch(o){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},o),{method:"PATCH"}))})()}delete(o){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},o),{method:"DELETE"}))})()}}A("CapacitorHttp",{web:()=>new te})},5346:(ae,M,f)=>{f.d(M,{ez:()=>p,tP:()=>u});var u=function(v){return v.Documents="DOCUMENTS",v.Data="DATA",v.Library="LIBRARY",v.Cache="CACHE",v.External="EXTERNAL",v.ExternalStorage="EXTERNAL_STORAGE",v}(u||{}),p=function(v){return v.UTF8="utf8",v.ASCII="ascii",v.UTF16="utf16",v}(p||{})},9235:(ae,M,f)=>{f.r(M),f.d(M,{ObservationReportPageModule:()=>d});var u=f(6814),p=f(849),C=f(95),k=f(4408),v=f(3564),D=f(5861),e=f(9212);const R=["videoElement"],I=["canvasElement"],Q=["imageElement"];let B=(()=>{var r;class a{constructor(t,n){this.dialogRef=t,this.data=n,this.photoCaptured=new e.vpe}ngOnInit(){}onTakePhoto(){navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}}}).catch(()=>navigator.mediaDevices.getUserMedia({video:!0})).then(t=>{this.stream=t,this.videoElement.nativeElement.srcObject=t}).catch(t=>{console.error("Error accessing camera: ",t)})}capturePhoto(){console.log("capturePhoto called");const t=this.canvasElement.nativeElement,n=t.getContext("2d");t.width=100,t.height=75,n.drawImage(this.videoElement.nativeElement,0,0,t.width,t.height),console.log("Image drawn onto canvas");const h=t.toDataURL("image/png");console.log("Image URL: ",h),this.imageElement.nativeElement.src=h,this.photoCaptured.emit(h),this.stream&&this.stream.getTracks().forEach(y=>y.stop())}onSelectPhoto(){this.dialogRef.close()}}return(r=a).\u0275fac=function(t){return new(t||r)(e.Y36(v.so),e.Y36(v.WI))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-select-photo-dialog"]],viewQuery:function(t,n){if(1&t&&(e.Gf(R,5),e.Gf(I,5),e.Gf(Q,5)),2&t){let s;e.iGM(s=e.CRH())&&(n.videoElement=s.first),e.iGM(s=e.CRH())&&(n.canvasElement=s.first),e.iGM(s=e.CRH())&&(n.imageElement=s.first)}},outputs:{photoCaptured:"photoCaptured"},decls:23,vars:1,consts:[[3,"translucent"],["color","Primary"],["mat-dialog-title",""],[1,"ion-activatable","ripple-parent","rounded-rectangle","ripple-effect-green",3,"click"],[1,"ion-activatable","ripple-parent","rounded-rectangle","ripple-effect-yellow",3,"click"],["autoplay",""],["videoElement",""],[2,"display","none"],["canvasElement",""],[3,"click"],["alt","UA photo","title","Photo of UA specimen"],["imageElement",""]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),e._uU(3," HOM Mobile Assistant - Take Photo of UA Specimen "),e.qZA()()(),e.TgZ(4,"h2",2),e._uU(5,"Select a photo"),e.qZA(),e.TgZ(6,"mat-dialog-content")(7,"p"),e._uU(8,"Would you like to take a new photo or select a photo from the gallery?"),e.qZA()(),e.TgZ(9,"mat-dialog-actions")(10,"div",3),e.NdJ("click",function(){return n.onTakePhoto()}),e._uU(11," Take Photo "),e.qZA(),e.TgZ(12,"div",4),e.NdJ("click",function(){return n.onSelectPhoto()}),e._uU(13," Select Photo "),e.qZA()(),e.TgZ(14,"p"),e._UZ(15,"video",5,6)(17,"canvas",7,8),e.qZA(),e.TgZ(19,"ion-button",9),e.NdJ("click",function(){return n.capturePhoto()}),e._uU(20,"Snap Photo"),e.qZA(),e._UZ(21,"img",10,11)),2&t&&e.Q6J("translucent",!0)},dependencies:[p.YG,p.Gu,p.wd,p.sr,v.uh,v.H8,v.xY],styles:[".ripple-effect-green[_ngcontent-%COMP%]{color:#09bc0c98}.ripple-effect-yellow[_ngcontent-%COMP%]{color:#cf0}.ripple-effect-orange[_ngcontent-%COMP%]{color:#fb0}video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;text-align:center;height:100px;width:200px;margin:0 auto}b[_ngcontent-%COMP%]{width:100%}.ripple-parent[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;border:1px solid #4194ab;width:100%;height:50px;border-radius:8px}.rounded-rectangle[_ngcontent-%COMP%]{width:200px;height:40px;border-radius:8px}"]}),a})();var K=f(2726),w=f(5346);const A=(0,K.fo)("Filesystem",{web:()=>f.e(4522).then(f.bind(f,4522)).then(r=>new r.FilesystemWeb)}),le=(0,K.fo)("Share",{web:()=>f.e(3420).then(f.bind(f,3420)).then(r=>new r.ShareWeb)});var se=f(553),j=f(6311),ce=f(5472);function H(r,a){if(1&r&&(e.TgZ(0,"ion-select-option",25),e._uU(1),e.qZA()),2&r){const c=a.$implicit;e.Q6J("value",c.id),e.xp6(),e.Oqu(c)}}function J(r,a){1&r&&(e.TgZ(0,"div"),e._uU(1," Invalid input: Please select an observation type "),e.qZA())}function z(r,a){1&r&&(e.TgZ(0,"div"),e._uU(1," Invalid input: Please select an observation tone "),e.qZA())}function de(r,a){1&r&&(e.TgZ(0,"div"),e._uU(1," Invalid input: Please select an observation class\n"),e.qZA())}function V(r,a){if(1&r){const c=e.EpF();e.TgZ(0,"div",26)(1,"ion-button",27),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.openSelectPhotoDialog())}),e._uU(2," Click to take/select photo of UA specimen\n"),e.qZA()()}}function X(r,a){if(1&r){const c=e.EpF();e.TgZ(0,"div"),e._UZ(1,"img",28)(2,"br"),e.TgZ(3,"ion-button",29),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.savePhoto())}),e._uU(4,"Save Photo"),e.qZA(),e._UZ(5,"br"),e.TgZ(6,"ion-button",29),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.getPhoto(n.savedPhotoPath))}),e._uU(7,"View Photo"),e.qZA(),e._UZ(8,"br")(9,"img",30)(10,"br"),e.TgZ(11,"ion-button",29),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.sharePhoto())}),e._uU(12,"Share Photo"),e.qZA(),e._UZ(13,"br"),e.qZA()}if(2&r){const c=e.oxw();e.xp6(),e.Q6J("src",c.capturedPhoto,e.LSH),e.xp6(2),e.Q6J("disabled",!c.capturedPhoto),e.xp6(3),e.Q6J("disabled",!c.capturedPhoto),e.xp6(3),e.Q6J("src",c.photoDataUrl,e.LSH),e.xp6(2),e.Q6J("disabled",!c.capturedPhoto)}}function ee(r,a){1&r&&(e.TgZ(0,"div"),e._uU(1," Invalid input: Please enter a detailed description "),e.qZA())}function G(r,a){1&r&&(e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e._uU(3,"Overnight Request"),e.qZA()(),e.TgZ(4,"ion-list")(5,"ion-item")(6,"div",31)(7,"label"),e._uU(8,"Departure Date & Time"),e.qZA(),e._UZ(9,"ion-input",32),e.qZA()(),e._UZ(10,"br"),e.TgZ(11,"ion-item")(12,"div",31)(13,"label"),e._uU(14,"Return Date & Time:"),e.qZA(),e._UZ(15,"ion-input",33),e.qZA()(),e._UZ(16,"br"),e.TgZ(17,"ion-item")(18,"div",31)(19,"label"),e._uU(20,"Location/Address:"),e.qZA(),e._UZ(21,"ion-input",34),e.qZA()(),e.TgZ(22,"ion-item")(23,"div",31)(24,"label"),e._uU(25,"County:"),e.qZA(),e._UZ(26,"ion-input",35),e.qZA()(),e.TgZ(27,"ion-item")(28,"div",31)(29,"label"),e._uU(30,"Emergency Contact:"),e.qZA(),e._UZ(31,"ion-input",36),e.qZA()(),e.TgZ(32,"ion-item")(33,"div",31)(34,"label"),e._uU(35,"Emergency Contact Phone:"),e.qZA(),e._UZ(36,"ion-input",37),e.qZA()(),e.TgZ(37,"ion-select",38)(38,"ion-select-option",39),e._uU(39,"Yes"),e.qZA(),e.TgZ(40,"ion-select-option",40),e._uU(41,"No"),e.qZA(),e.TgZ(42,"ion-select-option",41),e._uU(43,"N/A"),e.qZA()(),e.TgZ(44,"ion-select",42)(45,"ion-select-option",39),e._uU(46,"Yes"),e.qZA(),e.TgZ(47,"ion-select-option",40),e._uU(48,"No"),e.qZA(),e.TgZ(49,"ion-select-option",41),e._uU(50,"N/A"),e.qZA()(),e.TgZ(51,"ion-select",43)(52,"ion-select-option",39),e._uU(53,"Yes"),e.qZA(),e.TgZ(54,"ion-select-option",40),e._uU(55,"No"),e.qZA(),e.TgZ(56,"ion-select-option",41),e._uU(57,"N/A"),e.qZA()(),e.TgZ(58,"ion-select",44)(59,"ion-select-option",39),e._uU(60,"Yes"),e.qZA(),e.TgZ(61,"ion-select-option",40),e._uU(62,"No"),e.qZA(),e.TgZ(63,"ion-select-option",41),e._uU(64,"N/A"),e.qZA()(),e.TgZ(65,"ion-item"),e._UZ(66,"ion-textarea",45),e.qZA()()())}function te(r,a){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&r){const c=e.oxw();e.xp6(),e.hij("Record Number: ",c.NewObservationRecordId,"")}}function ue(r,a){if(1&r){const c=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.reportForm.valid&&n.insertObservationReport())}),e._uU(1," Add Observation Report "),e._UZ(2,"ion-ripple-effect"),e.qZA()}if(2&r){const c=e.oxw();e.ekj("disabled-button",!c.reportForm.valid)}}function l(r,a){if(1&r){const c=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.resetForm())}),e._uU(1," Reset Form "),e._UZ(2,"ion-ripple-effect"),e.qZA()}}const i=[{path:"",component:(()=>{var r;class a{constructor(t,n,s,g,h,y){this.router=t,this.location=n,this.quickbaseService=s,this.platform=g,this.formBuilder=h,this.dialog=y,this.photoCaptured=new e.vpe,this.apiKey=se.N.apiKey,this.NewObservationRecordId=0,this.showRipple=!1,this.capturedPhoto="",this.savedPhotoPath="",this.photoDataUrl="",this.isLoading=!1,this.reportForm=this.formBuilder.group({observationType:["",C.kI.required],observationTone:["",C.kI.required],observationClass:["",C.kI.required],observationDescription:["",C.kI.required],DepartureDateTime:[""],ReturnDateTime:[""],LocationAddress:[""],County:[""],EmergencyContactName:[""],EmergencyContactPhone:[""],ccoApproved:[""],sotpApproved:[""],safetyPlan:[""],attendMeeting:[""],ReasonForRequest:[""]})}savePhoto(){var t=this;return(0,D.Z)(function*(){try{if(!t.capturedPhoto)return console.error("No photo to save"),Promise.resolve(null);const n=t.capturedPhoto.split(",")[1],s=(new Date).getTime()+".jpeg";return yield A.writeFile({path:s,data:n,directory:w.tP.Data}),t.savedPhotoPath=s,console.log("Saved Photo Path:",t.savedPhotoPath),console.log("Saved Photo:",s),{filepath:s,webviewPath:t.capturedPhoto}}catch(n){return console.error("Failed to save photo to filesystem",n),Promise.reject(n)}})()}getPhoto(t){var n=this;return(0,D.Z)(function*(){try{const s=yield A.readFile({path:n.savedPhotoPath,directory:w.tP.Data});n.photoDataUrl="data:image/jpeg;base64,"+s.data,console.log("Photo Data URL:",n.photoDataUrl)}catch(s){return console.error("Failed to read photo from filesystem",s),Promise.reject(s)}})()}onObservationTypeChange(t){this.showRipple="Dirty UA"===t.name}sharePhoto(){var t=this;return(0,D.Z)(function*(){yield t.platform.ready(),console.log("Share Photo called");try{const n=yield A.readFile({path:t.savedPhotoPath,directory:w.tP.Data});t.photoDataUrl="data:image/jpeg;base64,"+n.data;const s="photo.jpg";yield A.writeFile({path:s,data:t.photoDataUrl,directory:w.tP.ExternalStorage}),console.log("Photo saved to gallery:",s);const g=cordova.file.externalRootDirectory+s;console.log("File URI:",g),console.log("About to share photo"),yield le.share({title:"Share Photo",text:"Here is a photo I took",url:g,dialogTitle:"Share Photo"}),console.log("Sharing completed")}catch(n){console.error("Error in sharePhoto: ",n)}})()}openSelectPhotoDialog(){const t=this.dialog.open(B,{width:"250px"});t.componentInstance.photoCaptured.subscribe(n=>{this.capturedPhoto=n,t.close()}),this.savePhoto()}addObservationReport(){this.router.navigate(["/home/observation-report"])}insertObservationReport(){var t=this;return(0,D.Z)(function*(){t.isLoading=!0;const s={194:{value:t.residentData.recordNumber2.value},7:{value:t.reportForm.value.observationType},51:{value:t.reportForm.value.observationTone},94:{value:t.reportForm.value.observationClass},8:{value:t.reportForm.value.observationDescription},119:{value:t.reportForm.value.DepartureDateTime},120:{value:t.reportForm.value.ReturnDateTime},121:{value:t.reportForm.value.LocationAddress},131:{value:t.reportForm.value.County},122:{value:t.reportForm.value.EmergencyContactName},123:{value:t.reportForm.value.EmergencyContactPhone},124:{value:t.reportForm.value.ccoApproved},125:{value:t.reportForm.value.sotpApproved},126:{value:t.reportForm.value.safetyPlan},127:{value:t.reportForm.value.ReasonForRequest},128:{value:t.reportForm.value.attendMeeting}};console.log("Observation Report Body:",s),t.quickbaseService.observationreport(s).subscribe(function(){var g=(0,D.Z)(function*(h){console.log("Observation Report inserted successfully",h),t.NewObservationRecordId=h.data[0][3].value,console.log("New Observation Record ID:",t.NewObservationRecordId),t.isLoading=!1;const $=yield(yield fetch(t.capturedPhoto)).blob(),Y=new File([$],"dirtyUA.png",{type:$.type}),q=new FileReader;console.log("File:",Y),q.onloadend=()=>{if("string"==typeof q.result){const oe=q.result.split(",")[1];t.quickbaseService.uploadFile(t.NewObservationRecordId.toString(),oe).subscribe(N=>{console.log("File uploaded successfully",N)},N=>{console.error("Error uploading file",N)})}},q.readAsDataURL(Y)});return function(h){return g.apply(this,arguments)}}(),g=>{console.error("Error inserting record",g)})})()}resetForm(){this.reportForm.reset(),this.NewObservationRecordId=0}goBack(){this.location.back()}ngOnInit(){const t=this.reportForm.get("observationType");t&&t.valueChanges.subscribe(s=>{this.onObservationTypeChange(s)});const n=this.router.getCurrentNavigation();n&&n.extras.state&&(this.residentData=n.extras.state.residentData,console.log("Resident Data:",this.residentData)),this.quickbaseService.getDropdownChoices().subscribe(s=>{this.dropdownChoices=s.properties.choices,console.log("Dropdown Choices:",this.dropdownChoices)})}}return(r=a).\u0275fac=function(t){return new(t||r)(e.Y36(k.F0),e.Y36(u.Ye),e.Y36(j.x),e.Y36(ce.t4),e.Y36(C.qu),e.Y36(v.uw))},r.\u0275cmp=e.Xpm({type:r,selectors:[["HOMMA-observationreport"]],inputs:{photo:"photo"},outputs:{photoCaptured:"photoCaptured"},decls:56,vars:16,consts:[[3,"translucent"],["color","Primary"],[3,"fullscreen"],[1,"ion-text-center"],["src","assets/logo/HOM.png","alt","Logo"],[3,"innerHTML"],[3,"formGroup"],["formControlName","observationType","label","Observation Type","interface","action-sheet","placeholder","Select the observation type","cancelText","Cancel Choice","label-placement","floating","fill","outline"],[3,"value",4,"ngFor","ngForOf"],[1,"error-message-text"],[4,"ngIf"],["formControlName","observationTone","label","Observation Tone","interface","action-sheet","placeholder","What is the particapant's emotion","label-placement","floating","fill","outline"],["value","Humble"],["value","Hostile"],["value","No Emotion"],["formControlName","observationClass","label","Observation Class","interface","action-sheet","placeholder","Is the observation positive, negative, or neutral?","label-placement","floating","fill","outline"],["value","Positive"],["value","Negative"],["value","Neutral"],["class","center-div",4,"ngIf"],["formControlName","observationDescription","label","Observation Description","labelPlacement","floating","placeholder","Please enter full details of the observation here","value","","autoGrow","true",1,"bordered-input"],[1,"wrapper"],["class","ion-activatable ripple-parent rounded-rectangle ripple-effect-blue",3,"disabled-button","click",4,"ngIf"],["class","ion-activatable ripple-parent rounded-rectangle ripple-effect-blue",3,"click",4,"ngIf"],[1,"ion-activatable","ripple-parent","rounded-rectangle","ripple-effect-blue",3,"click"],[3,"value"],[1,"center-div"],[3,"click"],["alt","Captured Photo placeholder",3,"src"],[3,"disabled","click"],["alt","Saved Photo placeholder",3,"src"],[1,"stacked-label"],["type","datetime-local","formControlName","DepartureDateTime"],["type","datetime-local","formControlName","ReturnDateTime"],["type","text","formControlName","LocationAddress","placeholder","Enter Location/Address"],["type","text","formControlName","County","placeholder","Enter County"],["type","text","formControlName","EmergencyContactName","placeholder","Enter Emergency Contact Name"],["type","text","formControlName","EmergencyContactPhone","placeholder","Enter Emergency Contact Phone"],["formControlName","ccoApproved","label","CCO Approved?","interface","action-sheet","placeholder","Select option for CCO Approval","label-placement","floating","fill","outline"],["value","Yes"],["value","No"],["value","N/A"],["formControlName","sotpApproved","label","SOTP Therapist Approved?","interface","action-sheet","placeholder","Select option for SOTP Therapist Approval","label-placement","floating","fill","outline"],["formControlName","safetyPlan","label","Safety Plan Required?","interface","action-sheet","placeholder","Select option if a safety plan is required","label-placement","floating","fill","outline"],["formControlName","attendMeeting","label","Attend Required Meeting?","interface","action-sheet","placeholder","Select option if a attending the meeting is required","label-placement","floating","fill","outline"],["formControlName","ReasonForRequest","label","Reason For Request","labelPlacement","floating","placeholder","Please enter reason for the overnight request here","value","","autoGrow","true",1,"bordered-input"]],template:function(t,n){if(1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),e._uU(3," HOM Mobile Assistant - Add Observation Report "),e.qZA()()(),e.TgZ(4,"ion-content",2)(5,"ion-card",3),e._UZ(6,"img",4)(7,"br"),e.TgZ(8,"ion-card-header"),e._uU(9," Add an Observation Report for: "),e.TgZ(10,"ion-card-subtitle"),e._UZ(11,"br")(12,"div",5),e._uU(13),e.qZA()()(),e.TgZ(14,"ion-card")(15,"ion-list",6)(16,"ion-select",7),e.YNc(17,H,2,2,"ion-select-option",8),e.qZA(),e.TgZ(18,"div",9),e.YNc(19,J,2,0,"div",10),e.qZA(),e.TgZ(20,"ion-select",11)(21,"ion-select-option",12),e._uU(22,"Humble"),e.qZA(),e.TgZ(23,"ion-select-option",13),e._uU(24,"Hostile"),e.qZA(),e.TgZ(25,"ion-select-option",14),e._uU(26,"No emotion"),e.qZA()(),e.TgZ(27,"div",9),e.YNc(28,z,2,0,"div",10),e.qZA(),e.TgZ(29,"ion-select",15)(30,"ion-select-option",16),e._uU(31,"Positive"),e.qZA(),e.TgZ(32,"ion-select-option",17),e._uU(33,"Negative"),e.qZA(),e.TgZ(34,"ion-select-option",18),e._uU(35,"Neutral"),e.qZA()(),e.TgZ(36,"div",9),e.YNc(37,de,2,0,"div",10),e.qZA(),e._UZ(38,"br"),e.YNc(39,V,3,0,"div",19),e._UZ(40,"br"),e.YNc(41,X,14,5,"div",10),e.TgZ(42,"ion-list")(43,"ion-item"),e._UZ(44,"ion-textarea",20),e.qZA(),e.TgZ(45,"div",9),e.YNc(46,ee,2,0,"div",10),e.qZA(),e.YNc(47,G,67,0,"ion-card",10),e.TgZ(48,"div",21),e.YNc(49,te,2,1,"p",10)(50,ue,3,2,"div",22)(51,l,3,0,"div",23),e._UZ(52,"br"),e.TgZ(53,"div",24),e.NdJ("click",function(){return n.goBack()}),e._uU(54," Back/Start Over "),e._UZ(55,"ion-ripple-effect"),e.qZA()()()()()()),2&t){let s,g;e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(8),e.Q6J("innerHTML",n.residentData.residentPhoto.value,e.oJD),e.xp6(),e.hij(" ",n.residentData.residentFullName.value," "),e.xp6(2),e.Q6J("formGroup",n.reportForm),e.xp6(2),e.Q6J("ngForOf",n.dropdownChoices),e.xp6(2),e.Q6J("ngIf",(null==n.reportForm.controls.observationType?null:n.reportForm.controls.observationType.invalid)&&n.reportForm.controls.observationType.touched),e.xp6(9),e.Q6J("ngIf",(null==n.reportForm.controls.observationTone?null:n.reportForm.controls.observationTone.invalid)&&n.reportForm.controls.observationTone.touched),e.xp6(9),e.Q6J("ngIf",(null==n.reportForm.controls.observationClass?null:n.reportForm.controls.observationClass.invalid)&&n.reportForm.controls.observationClass.touched),e.xp6(2),e.Q6J("ngIf","Dirty UA"===(null==(s=n.reportForm.get("observationType"))?null:s.value)),e.xp6(2),e.Q6J("ngIf",n.capturedPhoto),e.xp6(5),e.Q6J("ngIf",(null==n.reportForm.controls.observationDescription?null:n.reportForm.controls.observationDescription.invalid)&&n.reportForm.controls.observationDescription.touched),e.xp6(),e.Q6J("ngIf","Overnight Request"===(null==(g=n.reportForm.get("observationType"))?null:g.value)),e.xp6(2),e.Q6J("ngIf",n.NewObservationRecordId),e.xp6(),e.Q6J("ngIf",!n.NewObservationRecordId),e.xp6(),e.Q6J("ngIf",n.NewObservationRecordId)}},dependencies:[u.sg,u.O5,C.JJ,C.JL,p.YG,p.PM,p.Zi,p.tO,p.Dq,p.W2,p.Gu,p.pK,p.Ie,p.q_,p.H$,p.t9,p.n0,p.g2,p.wd,p.sr,p.QI,p.j9,C.sg,C.u],styles:["ion-header[_ngcontent-%COMP%]{--ion-background-color: #4194ab !important;--ion-color-base: #fff !important}ion-title[_ngcontent-%COMP%]{--ion-color-base: #fff !important;font-size:16px}ion-card-header[_ngcontent-%COMP%]{--padding-bottom: 0;font-size:16px;font-weight:700}ion-card-subtitle[_ngcontent-%COMP%]{--ion-color-base: #000 !important;font-size:12px;font-weight:inherit}ion-card-title[_ngcontent-%COMP%]{text-align:left}.error-message[_ngcontent-%COMP%]{color:red;font-size:20px;margin-top:10px}ion-card[_ngcontent-%COMP%]{justify-content:center}ion-card[_ngcontent-%COMP%]   .error-message-text[_ngcontent-%COMP%]{text-align:center;color:#87130a}ion-select[_ngcontent-%COMP%]{margin:0;padding:10px}form[_ngcontent-%COMP%]{margin:0;padding:10px}.ripple-effect-blue[_ngcontent-%COMP%]{color:#010384}.ripple-effect-lightblue[_ngcontent-%COMP%]{color:#00c8ff}.ripple-effect-orange[_ngcontent-%COMP%]{color:#6c5105;font-size:x-small}.wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;text-align:center;height:100px;width:200px;margin:0 auto}b[_ngcontent-%COMP%]{width:100%}.center-div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:100%}.ripple-parent[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;border:1px solid #4194ab;width:100%;height:50px;border-radius:8px}.rounded-rectangle[_ngcontent-%COMP%]{width:200px;height:40px;border-radius:8px}.bordered-input[_ngcontent-%COMP%]{border:1px solid #4194ab;white-space:pre-wrap}.stacked-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;color:#4194ab}ion-button[_ngcontent-%COMP%]{--padding-start: 10px;--padding-end: 10px;--padding-top: 0px;--padding-bottom: 0px;--background: #87130a;--color: #fff;--border-radius: 8px;font-size:12px;font-weight:700}"]}),a})()}];let d=(()=>{var r;class a{}return(r=a).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.ez,C.u5,p.Pc,C.UX,v.Is,k.Bz.forChild(i)]}),a})()}}]);